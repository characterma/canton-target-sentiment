2021-07-05 04:11:38 ***** Args *****
2021-07-05 04:11:38    task: chinese_word_segmentation
2021-07-05 04:11:38    device: 0
2021-07-05 04:11:38    data: {'output_dir': '../output/cws_20210630_cnn_crf', 'data_dir': '../data/datasets/canton_ws', 'train': 'train.json', 'dev': 'dev.json', 'test': 'test.json', 'unlabeled': 'unlabeled.json'}
2021-07-05 04:11:38    text_prepro: {'steps': ['full_to_half']}
2021-07-05 04:11:38    eval: {'batch_size': 64, 'model_file': 'model.pt'}
2021-07-05 04:11:38    train: {'model_class': 'CNN_CRF', 'kd': {'use_kd': False, 'teacher_dir': '../output/post_sentiment_20210702_bert_cls/model', 'loss_type': 'mse', 'soft_lambda': 0.5, 'kl_T': 5}, 'seed': 42, 'log_steps': 100, 'batch_size': 32, 'final_model': 'best', 'optimization_metric': 'macro_f1', 'early_stop': 5}
2021-07-05 04:11:38    model_params: {'num_train_epochs': 35, 'embedding_trainable': True}
2021-07-05 04:11:38 ***** Loading tokenizer *****
2021-07-05 04:11:38   Tokenizer source = 'char_split'
2021-07-05 04:11:38 ***** Building vocab from dataset *****
2021-07-05 04:11:38   Datasets = ['train']
2021-07-05 04:11:41   Number of infrequency words = 32
2021-07-05 04:11:41   Infrequenct words = 32
2021-07-05 04:11:41   Vocab size = 3178
2021-07-05 04:11:45 ***** Initializing model *****
2021-07-05 04:11:45   Task = chinese_word_segmentation
2021-07-05 04:11:45   Model class = CNN_CRF
2021-07-05 04:11:52 ***** Loading data *****
2021-07-05 04:11:52   Data path = ../data/datasets/canton_ws/train.json
2021-07-05 04:11:56   Loaded samples = 1956
2021-07-05 04:11:56 ***** Loading data *****
2021-07-05 04:11:56   Data path = ../data/datasets/canton_ws/dev.json
2021-07-05 04:11:57   Loaded samples = 244
2021-07-05 04:11:57 ***** Running training *****
2021-07-05 04:11:57   Num examples = 1956
2021-07-05 04:11:57   Num Epochs = 35
2021-07-05 04:11:57   Sampler = 
2021-07-05 04:11:57   Batch size = 32
2021-07-05 04:11:57   Gradient Accumulation steps = 1
2021-07-05 04:12:19 ***** Epoch end: 0 *****
2021-07-05 04:12:19 ***** Running evaluation *****
2021-07-05 04:12:19   Num examples = 244
2021-07-05 04:12:19   Batch size = 64
2021-07-05 04:12:20   macro_f1 = 0.4939889136851199
2021-07-05 04:12:20   micro_f1 = 0.4939889136851199
2021-07-05 04:12:20   support = 6390
2021-07-05 04:12:20   O-precision = 0.45740567924276765
2021-07-05 04:12:20   O-recall = 0.5369327073552426
2021-07-05 04:12:20   O-f1-score = 0.4939889136851199
2021-07-05 04:12:20   O-support = 6390
2021-07-05 04:12:20   loss = 23.490203380584717
2021-07-05 04:12:20   dataset = dev
2021-07-05 04:12:40 ***** Epoch end: 1 *****
2021-07-05 04:12:40 ***** Running evaluation *****
2021-07-05 04:12:40   Num examples = 244
2021-07-05 04:12:40   Batch size = 64
2021-07-05 04:12:42   macro_f1 = 0.5755661685410569
2021-07-05 04:12:42   micro_f1 = 0.5755661685410569
2021-07-05 04:12:42   support = 6390
2021-07-05 04:12:42   O-precision = 0.566747572815534
2021-07-05 04:12:42   O-recall = 0.5846635367762129
2021-07-05 04:12:42   O-f1-score = 0.5755661685410569
2021-07-05 04:12:42   O-support = 6390
2021-07-05 04:12:42   loss = 19.694830894470215
2021-07-05 04:12:42   dataset = dev
2021-07-05 04:13:02 ***** Epoch end: 2 *****
2021-07-05 04:13:02 ***** Running evaluation *****
2021-07-05 04:13:02   Num examples = 244
2021-07-05 04:13:02   Batch size = 64
2021-07-05 04:13:04   macro_f1 = 0.6219781895828567
2021-07-05 04:13:04   micro_f1 = 0.6219781895828567
2021-07-05 04:13:04   support = 6390
2021-07-05 04:13:04   O-precision = 0.6065744459318757
2021-07-05 04:13:04   O-recall = 0.6381846635367762
2021-07-05 04:13:04   O-f1-score = 0.6219781895828567
2021-07-05 04:13:04   O-support = 6390
2021-07-05 04:13:04   loss = 17.705405712127686
2021-07-05 04:13:04   dataset = dev
2021-07-05 04:13:24 ***** Epoch end: 3 *****
2021-07-05 04:13:24 ***** Running evaluation *****
2021-07-05 04:13:24   Num examples = 244
2021-07-05 04:13:24   Batch size = 64
2021-07-05 04:13:25   macro_f1 = 0.6612174996107738
2021-07-05 04:13:25   micro_f1 = 0.6612174996107739
2021-07-05 04:13:25   support = 6390
2021-07-05 04:13:25   O-precision = 0.6578376703841388
2021-07-05 04:13:25   O-recall = 0.6646322378716745
2021-07-05 04:13:25   O-f1-score = 0.6612174996107738
2021-07-05 04:13:25   O-support = 6390
2021-07-05 04:13:25   loss = 16.049106121063232
2021-07-05 04:13:25   dataset = dev
2021-07-05 04:13:45 ***** Epoch end: 4 *****
2021-07-05 04:13:45 ***** Running evaluation *****
2021-07-05 04:13:45   Num examples = 244
2021-07-05 04:13:45   Batch size = 64
2021-07-05 04:13:47   macro_f1 = 0.6850273889227023
2021-07-05 04:13:47   micro_f1 = 0.6850273889227023
2021-07-05 04:13:47   support = 6390
2021-07-05 04:13:47   O-precision = 0.6665679597275689
2021-07-05 04:13:47   O-recall = 0.7045383411580595
2021-07-05 04:13:47   O-f1-score = 0.6850273889227023
2021-07-05 04:13:47   O-support = 6390
2021-07-05 04:13:47   loss = 15.269756078720093
2021-07-05 04:13:47   dataset = dev
2021-07-05 04:14:08 ***** Epoch end: 5 *****
2021-07-05 04:14:08 ***** Running evaluation *****
2021-07-05 04:14:08   Num examples = 244
2021-07-05 04:14:08   Batch size = 64
2021-07-05 04:14:10   macro_f1 = 0.6945719259376484
2021-07-05 04:14:10   micro_f1 = 0.6945719259376483
2021-07-05 04:14:10   support = 6390
2021-07-05 04:14:10   O-precision = 0.7024647887323944
2021-07-05 04:14:10   O-recall = 0.6868544600938967
2021-07-05 04:14:10   O-f1-score = 0.6945719259376484
2021-07-05 04:14:10   O-support = 6390
2021-07-05 04:14:10   loss = 14.351723670959473
2021-07-05 04:14:10   dataset = dev
2021-07-05 04:14:31 ***** Epoch end: 6 *****
2021-07-05 04:14:31 ***** Running evaluation *****
2021-07-05 04:14:31   Num examples = 244
2021-07-05 04:14:31   Batch size = 64
2021-07-05 04:14:33   macro_f1 = 0.7012694841716214
2021-07-05 04:14:33   micro_f1 = 0.7012694841716214
2021-07-05 04:14:33   support = 6390
2021-07-05 04:14:33   O-precision = 0.7206076618229855
2021-07-05 04:14:33   O-recall = 0.682942097026604
2021-07-05 04:14:33   O-f1-score = 0.7012694841716214
2021-07-05 04:14:33   O-support = 6390
2021-07-05 04:14:33   loss = 14.11405634880066
2021-07-05 04:14:33   dataset = dev
2021-07-05 04:14:55 ***** Epoch end: 7 *****
2021-07-05 04:14:55 ***** Running evaluation *****
2021-07-05 04:14:55   Num examples = 244
2021-07-05 04:14:55   Batch size = 64
2021-07-05 04:14:56   macro_f1 = 0.7257925636007828
2021-07-05 04:14:56   micro_f1 = 0.7257925636007828
2021-07-05 04:14:56   support = 6390
2021-07-05 04:14:56   O-precision = 0.7260767423649178
2021-07-05 04:14:56   O-recall = 0.725508607198748
2021-07-05 04:14:56   O-f1-score = 0.7257925636007828
2021-07-05 04:14:56   O-support = 6390
2021-07-05 04:14:56   loss = 13.510530471801758
2021-07-05 04:14:56   dataset = dev
2021-07-05 04:15:17 ***** Epoch end: 8 *****
2021-07-05 04:15:17 ***** Running evaluation *****
2021-07-05 04:15:17   Num examples = 244
2021-07-05 04:15:17   Batch size = 64
2021-07-05 04:15:18   macro_f1 = 0.7363820820977056
2021-07-05 04:15:18   micro_f1 = 0.7363820820977056
2021-07-05 04:15:18   support = 6390
2021-07-05 04:15:18   O-precision = 0.7344333748443338
2021-07-05 04:15:18   O-recall = 0.7383411580594679
2021-07-05 04:15:18   O-f1-score = 0.7363820820977056
2021-07-05 04:15:18   O-support = 6390
2021-07-05 04:15:18   loss = 13.181609869003296
2021-07-05 04:15:18   dataset = dev
2021-07-05 04:15:38 ***** Epoch end: 9 *****
2021-07-05 04:15:38 ***** Running evaluation *****
2021-07-05 04:15:38   Num examples = 244
2021-07-05 04:15:38   Batch size = 64
2021-07-05 04:15:40   macro_f1 = 0.7377049180327868
2021-07-05 04:15:40   micro_f1 = 0.7377049180327868
2021-07-05 04:15:40   support = 6390
2021-07-05 04:15:40   O-precision = 0.7430930454112417
2021-07-05 04:15:40   O-recall = 0.7323943661971831
2021-07-05 04:15:40   O-f1-score = 0.7377049180327868
2021-07-05 04:15:40   O-support = 6390
2021-07-05 04:15:40   loss = 12.878509521484375
2021-07-05 04:15:40   dataset = dev
2021-07-05 04:16:00 ***** Epoch end: 10 *****
2021-07-05 04:16:00 ***** Running evaluation *****
2021-07-05 04:16:00   Num examples = 244
2021-07-05 04:16:00   Batch size = 64
2021-07-05 04:16:02   macro_f1 = 0.7449595983368635
2021-07-05 04:16:02   micro_f1 = 0.7449595983368635
2021-07-05 04:16:02   support = 6390
2021-07-05 04:16:02   O-precision = 0.74689318861098
2021-07-05 04:16:02   O-recall = 0.7430359937402191
2021-07-05 04:16:02   O-f1-score = 0.7449595983368635
2021-07-05 04:16:02   O-support = 6390
2021-07-05 04:16:02   loss = 12.736726999282837
2021-07-05 04:16:02   dataset = dev
2021-07-05 04:16:22 ***** Epoch end: 11 *****
2021-07-05 04:16:22 ***** Running evaluation *****
2021-07-05 04:16:22   Num examples = 244
2021-07-05 04:16:22   Batch size = 64
2021-07-05 04:16:24   macro_f1 = 0.7502351834430857
2021-07-05 04:16:24   micro_f1 = 0.7502351834430857
2021-07-05 04:16:24   support = 6390
2021-07-05 04:16:24   O-precision = 0.7516493873704053
2021-07-05 04:16:24   O-recall = 0.7488262910798122
2021-07-05 04:16:24   O-f1-score = 0.7502351834430857
2021-07-05 04:16:24   O-support = 6390
2021-07-05 04:16:24   loss = 12.571359872817993
2021-07-05 04:16:24   dataset = dev
2021-07-05 04:16:44 ***** Epoch end: 12 *****
2021-07-05 04:16:44 ***** Running evaluation *****
2021-07-05 04:16:44   Num examples = 244
2021-07-05 04:16:44   Batch size = 64
2021-07-05 04:16:45   macro_f1 = 0.755444148519505
2021-07-05 04:16:45   micro_f1 = 0.7554441485195049
2021-07-05 04:16:45   support = 6390
2021-07-05 04:16:45   O-precision = 0.7562735257214555
2021-07-05 04:16:45   O-recall = 0.7546165884194053
2021-07-05 04:16:45   O-f1-score = 0.755444148519505
2021-07-05 04:16:45   O-support = 6390
2021-07-05 04:16:45   loss = 12.514136552810669
2021-07-05 04:16:45   dataset = dev
2021-07-05 04:17:05 ***** Epoch end: 13 *****
2021-07-05 04:17:05 ***** Running evaluation *****
2021-07-05 04:17:05   Num examples = 244
2021-07-05 04:17:05   Batch size = 64
2021-07-05 04:17:07   macro_f1 = 0.7546424338206242
2021-07-05 04:17:07   micro_f1 = 0.7546424338206242
2021-07-05 04:17:07   support = 6390
2021-07-05 04:17:07   O-precision = 0.762170790103751
2021-07-05 04:17:07   O-recall = 0.7472613458528952
2021-07-05 04:17:07   O-f1-score = 0.7546424338206242
2021-07-05 04:17:07   O-support = 6390
2021-07-05 04:17:07   loss = 12.501532077789307
2021-07-05 04:17:07   dataset = dev
2021-07-05 04:17:27 ***** Epoch end: 14 *****
2021-07-05 04:17:27 ***** Running evaluation *****
2021-07-05 04:17:27   Num examples = 244
2021-07-05 04:17:27   Batch size = 64
2021-07-05 04:17:29   macro_f1 = 0.7604485219164119
2021-07-05 04:17:29   micro_f1 = 0.7604485219164119
2021-07-05 04:17:29   support = 6390
2021-07-05 04:17:29   O-precision = 0.7620619204777621
2021-07-05 04:17:29   O-recall = 0.7588419405320814
2021-07-05 04:17:29   O-f1-score = 0.7604485219164119
2021-07-05 04:17:29   O-support = 6390
2021-07-05 04:17:29   loss = 12.526244640350342
2021-07-05 04:17:29   dataset = dev
2021-07-05 04:17:49 ***** Epoch end: 15 *****
2021-07-05 04:17:49 ***** Running evaluation *****
2021-07-05 04:17:49   Num examples = 244
2021-07-05 04:17:49   Batch size = 64
2021-07-05 04:17:51   macro_f1 = 0.7598027706034279
2021-07-05 04:17:51   micro_f1 = 0.7598027706034279
2021-07-05 04:17:51   support = 6390
2021-07-05 04:17:51   O-precision = 0.759981211836543
2021-07-05 04:17:51   O-recall = 0.7596244131455399
2021-07-05 04:17:51   O-f1-score = 0.7598027706034279
2021-07-05 04:17:51   O-support = 6390
2021-07-05 04:17:51   loss = 12.519777059555054
2021-07-05 04:17:51   dataset = dev
2021-07-05 04:18:11 ***** Epoch end: 16 *****
2021-07-05 04:18:11 ***** Running evaluation *****
2021-07-05 04:18:11   Num examples = 244
2021-07-05 04:18:11   Batch size = 64
2021-07-05 04:18:12   macro_f1 = 0.7633232487782173
2021-07-05 04:18:12   micro_f1 = 0.7633232487782173
2021-07-05 04:18:12   support = 6390
2021-07-05 04:18:12   O-precision = 0.7568066451315182
2021-07-05 04:18:12   O-recall = 0.7699530516431925
2021-07-05 04:18:12   O-f1-score = 0.7633232487782173
2021-07-05 04:18:12   O-support = 6390
2021-07-05 04:18:12   loss = 12.646824836730957
2021-07-05 04:18:12   dataset = dev
2021-07-05 04:18:32 ***** Epoch end: 17 *****
2021-07-05 04:18:32 ***** Running evaluation *****
2021-07-05 04:18:32   Num examples = 244
2021-07-05 04:18:32   Batch size = 64
2021-07-05 04:18:34   macro_f1 = 0.7626136007521154
2021-07-05 04:18:34   micro_f1 = 0.7626136007521154
2021-07-05 04:18:34   support = 6390
2021-07-05 04:18:34   O-precision = 0.7635707561970505
2021-07-05 04:18:34   O-recall = 0.7616588419405321
2021-07-05 04:18:34   O-f1-score = 0.7626136007521154
2021-07-05 04:18:34   O-support = 6390
2021-07-05 04:18:34   loss = 12.65449571609497
2021-07-05 04:18:34   dataset = dev
2021-07-05 04:18:54 ***** Epoch end: 18 *****
2021-07-05 04:18:54 ***** Running evaluation *****
2021-07-05 04:18:54   Num examples = 244
2021-07-05 04:18:54   Batch size = 64
2021-07-05 04:18:56   macro_f1 = 0.7619646365422398
2021-07-05 04:18:56   micro_f1 = 0.7619646365422398
2021-07-05 04:18:56   support = 6390
2021-07-05 04:18:56   O-precision = 0.7652722967640094
2021-07-05 04:18:56   O-recall = 0.7586854460093897
2021-07-05 04:18:56   O-f1-score = 0.7619646365422398
2021-07-05 04:18:56   O-support = 6390
2021-07-05 04:18:56   loss = 12.909453392028809
2021-07-05 04:18:56   dataset = dev
2021-07-05 04:19:16 ***** Epoch end: 19 *****
2021-07-05 04:19:16 ***** Running evaluation *****
2021-07-05 04:19:16   Num examples = 244
2021-07-05 04:19:16   Batch size = 64
2021-07-05 04:19:17   macro_f1 = 0.7623008710664678
2021-07-05 04:19:17   micro_f1 = 0.7623008710664678
2021-07-05 04:19:17   support = 6390
2021-07-05 04:19:17   O-precision = 0.7645206988824178
2021-07-05 04:19:17   O-recall = 0.760093896713615
2021-07-05 04:19:17   O-f1-score = 0.7623008710664678
2021-07-05 04:19:17   O-support = 6390
2021-07-05 04:19:17   loss = 12.889632940292358
2021-07-05 04:19:17   dataset = dev
2021-07-05 04:19:17 ***** Training end *****
2021-07-05 04:19:17   Model path = ../output/cws_20210630_cnn_crf/model/model.pt
2021-07-05 04:19:17 ***** Loading data *****
2021-07-05 04:19:17   Data path = ../data/datasets/canton_ws/test.json
2021-07-05 04:19:18   Loaded samples = 245
2021-07-05 04:19:18 ***** Running evaluation *****
2021-07-05 04:19:18   Num examples = 1956
2021-07-05 04:19:18   Batch size = 64
2021-07-05 04:19:31   macro_f1 = 0.8919536606509575
2021-07-05 04:19:31   micro_f1 = 0.8919536606509574
2021-07-05 04:19:31   support = 50347
2021-07-05 04:19:31   O-precision = 0.884823609889573
2021-07-05 04:19:31   O-recall = 0.8991995550876914
2021-07-05 04:19:31   O-f1-score = 0.8919536606509575
2021-07-05 04:19:31   O-support = 50347
2021-07-05 04:19:31   loss = 5.744667083986344
2021-07-05 04:19:31   dataset = train
2021-07-05 04:19:31 ***** Running evaluation *****
2021-07-05 04:19:31   Num examples = 244
2021-07-05 04:19:31   Batch size = 64
2021-07-05 04:19:33   macro_f1 = 0.7633232487782173
2021-07-05 04:19:33   micro_f1 = 0.7633232487782173
2021-07-05 04:19:33   support = 6390
2021-07-05 04:19:33   O-precision = 0.7568066451315182
2021-07-05 04:19:33   O-recall = 0.7699530516431925
2021-07-05 04:19:33   O-f1-score = 0.7633232487782173
2021-07-05 04:19:33   O-support = 6390
2021-07-05 04:19:33   loss = 12.646824836730957
2021-07-05 04:19:33   dataset = dev
2021-07-05 04:19:33 ***** Running evaluation *****
2021-07-05 04:19:33   Num examples = 245
2021-07-05 04:19:33   Batch size = 64
2021-07-05 04:19:34   macro_f1 = 0.7512082853855006
2021-07-05 04:19:34   micro_f1 = 0.7512082853855006
2021-07-05 04:19:34   support = 6413
2021-07-05 04:19:34   O-precision = 0.7393536695862277
2021-07-05 04:19:34   O-recall = 0.7634492437236863
2021-07-05 04:19:34   O-f1-score = 0.7512082853855006
2021-07-05 04:19:34   O-support = 6413
2021-07-05 04:19:34   loss = 13.307294607162476
2021-07-05 04:19:34   dataset = test
