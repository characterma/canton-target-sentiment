2021-06-30 09:25:39 ***** Args *****
2021-06-30 09:25:39    task: chinese_word_segmentation
2021-06-30 09:25:39    device: 2
2021-06-30 09:25:39    data: {'output_dir': '../output/cws_20210630_bert_crf_bert_base', 'data_dir': '../data/datasets/canton_ws', 'train': 'train.json', 'dev': 'dev.json', 'test': 'test.json', 'unlabeled': 'unlabeled.json'}
2021-06-30 09:25:39    text_prepro: {'steps': ['utf8_replace', 'simplified_chinese', 'lower_case', 'full_to_half']}
2021-06-30 09:25:39    eval: {'batch_size': 64, 'model_file': 'model.pt'}
2021-06-30 09:25:39    train: {'model_class': 'BERT_CRF', 'kd': {'use_kd': False, 'teacher_dir': '../output/post_sentiment_20210623_bert_avg/model', 'loss_type': 'mse', 'soft_lambda': 0.5, 'kl_T': 5}, 'seed': 42, 'log_steps': 100, 'batch_size': 32, 'final_model': 'best', 'optimization_metric': 'macro_f1', 'early_stop': 5}
2021-06-30 09:25:39    model_params: {'num_train_epochs': 20, 'embedding_trainable': True}
2021-06-30 09:25:39 ***** Loading tokenizer *****
2021-06-30 09:25:39   Tokenizer source = 'transformers'
2021-06-30 09:25:46 ***** Initializing model *****
2021-06-30 09:25:46   Task = chinese_word_segmentation
2021-06-30 09:25:46   Model class = BERT_CRF
2021-06-30 09:25:47 ***** Loading pretrained language model *****
2021-06-30 09:25:47   Pretrained BERT = 'bert-base-chinese'
2021-06-30 09:25:59 ***** Loading data *****
2021-06-30 09:25:59   Data path = ../data/datasets/canton_ws/train.json
2021-06-30 09:25:59   Number of raw samples = 1956
2021-06-30 09:26:03   Number of loaded samples = 1956
2021-06-30 09:26:03 ***** Loading data *****
2021-06-30 09:26:03   Data path = ../data/datasets/canton_ws/dev.json
2021-06-30 09:26:03   Number of raw samples = 244
2021-06-30 09:26:03   Number of loaded samples = 244
2021-06-30 09:26:03 ***** Running training *****
2021-06-30 09:26:03   Num examples = 1956
2021-06-30 09:26:03   Num Epochs = 20
2021-06-30 09:26:03   Sampler = 
2021-06-30 09:26:03   Batch size = 32
2021-06-30 09:26:03   Gradient Accumulation steps = 1
2021-06-30 09:26:56 ***** Epoch end: 0 *****
2021-06-30 09:26:56 ***** Running evaluation *****
2021-06-30 09:26:56   Num examples = 244
2021-06-30 09:26:56   Batch size = 64
2021-06-30 09:27:02   macro_f1 = 0.8749797570850202
2021-06-30 09:27:02   micro_f1 = 0.8749797570850202
2021-06-30 09:27:02   support = 6242
2021-06-30 09:27:02   O-precision = 0.8845776031434185
2021-06-30 09:27:02   O-recall = 0.8655879525793015
2021-06-30 09:27:02   O-f1-score = 0.8749797570850202
2021-06-30 09:27:02   O-support = 6242
2021-06-30 09:27:02   loss = 6.318028926849365
2021-06-30 09:27:02   dataset = dev
2021-06-30 09:27:54 ***** Epoch end: 1 *****
2021-06-30 09:27:54 ***** Running evaluation *****
2021-06-30 09:27:54   Num examples = 244
2021-06-30 09:27:54   Batch size = 64
2021-06-30 09:28:00   macro_f1 = 0.8932223543400714
2021-06-30 09:28:00   micro_f1 = 0.8932223543400714
2021-06-30 09:28:00   support = 6242
2021-06-30 09:28:00   O-precision = 0.8840420524085988
2021-06-30 09:28:00   O-recall = 0.9025953220121756
2021-06-30 09:28:00   O-f1-score = 0.8932223543400714
2021-06-30 09:28:00   O-support = 6242
2021-06-30 09:28:00   loss = 5.2999656200408936
2021-06-30 09:28:00   dataset = dev
2021-06-30 09:28:52 ***** Epoch end: 2 *****
2021-06-30 09:28:52 ***** Running evaluation *****
2021-06-30 09:28:52   Num examples = 244
2021-06-30 09:28:52   Batch size = 64
2021-06-30 09:28:58   macro_f1 = 0.8974522292993631
2021-06-30 09:28:58   micro_f1 = 0.8974522292993631
2021-06-30 09:28:58   support = 6242
2021-06-30 09:28:58   O-precision = 0.8920544476100032
2021-06-30 09:28:58   O-recall = 0.9029157321371355
2021-06-30 09:28:58   O-f1-score = 0.8974522292993631
2021-06-30 09:28:58   O-support = 6242
2021-06-30 09:28:58   loss = 5.182801961898804
2021-06-30 09:28:58   dataset = dev
2021-06-30 09:29:51 ***** Epoch end: 3 *****
2021-06-30 09:29:51 ***** Running evaluation *****
2021-06-30 09:29:51   Num examples = 244
2021-06-30 09:29:51   Batch size = 64
2021-06-30 09:29:56   macro_f1 = 0.9037334403853874
2021-06-30 09:29:56   micro_f1 = 0.9037334403853874
2021-06-30 09:29:56   support = 6242
2021-06-30 09:29:56   O-precision = 0.9058425881216804
2021-06-30 09:29:56   O-recall = 0.9016340916372957
2021-06-30 09:29:56   O-f1-score = 0.9037334403853874
2021-06-30 09:29:56   O-support = 6242
2021-06-30 09:29:56   loss = 5.186095833778381
2021-06-30 09:29:56   dataset = dev
2021-06-30 09:30:49 ***** Epoch end: 4 *****
2021-06-30 09:30:49 ***** Running evaluation *****
2021-06-30 09:30:49   Num examples = 244
2021-06-30 09:30:49   Batch size = 64
2021-06-30 09:30:55   macro_f1 = 0.9012764582323477
2021-06-30 09:30:55   micro_f1 = 0.9012764582323476
2021-06-30 09:30:55   support = 6242
2021-06-30 09:30:55   O-precision = 0.9090612777053455
2021-06-30 09:30:55   O-recall = 0.8936238385132971
2021-06-30 09:30:55   O-f1-score = 0.9012764582323477
2021-06-30 09:30:55   O-support = 6242
2021-06-30 09:30:55   loss = 5.939351201057434
2021-06-30 09:30:55   dataset = dev
2021-06-30 09:31:46 ***** Epoch end: 5 *****
2021-06-30 09:31:46 ***** Running evaluation *****
2021-06-30 09:31:46   Num examples = 244
2021-06-30 09:31:46   Batch size = 64
2021-06-30 09:31:52   macro_f1 = 0.9042851421706048
2021-06-30 09:31:52   micro_f1 = 0.9042851421706048
2021-06-30 09:31:52   support = 6242
2021-06-30 09:31:52   O-precision = 0.9042127182444337
2021-06-30 09:31:52   O-recall = 0.9043575776994554
2021-06-30 09:31:52   O-f1-score = 0.9042851421706048
2021-06-30 09:31:52   O-support = 6242
2021-06-30 09:31:52   loss = 6.187321424484253
2021-06-30 09:31:52   dataset = dev
2021-06-30 09:32:44 ***** Epoch end: 6 *****
2021-06-30 09:32:44 ***** Running evaluation *****
2021-06-30 09:32:44   Num examples = 244
2021-06-30 09:32:44   Batch size = 64
2021-06-30 09:32:50   macro_f1 = 0.9062199422891952
2021-06-30 09:32:50   micro_f1 = 0.9062199422891952
2021-06-30 09:32:50   support = 6242
2021-06-30 09:32:50   O-precision = 0.9068014116137312
2021-06-30 09:32:50   O-recall = 0.905639218199295
2021-06-30 09:32:50   O-f1-score = 0.9062199422891952
2021-06-30 09:32:50   O-support = 6242
2021-06-30 09:32:50   loss = 6.586900115013123
2021-06-30 09:32:50   dataset = dev
2021-06-30 09:33:42 ***** Epoch end: 7 *****
2021-06-30 09:33:42 ***** Running evaluation *****
2021-06-30 09:33:42   Num examples = 244
2021-06-30 09:33:42   Batch size = 64
2021-06-30 09:33:48   macro_f1 = 0.9044341283816231
2021-06-30 09:33:48   micro_f1 = 0.9044341283816231
2021-06-30 09:33:48   support = 6242
2021-06-30 09:33:48   O-precision = 0.9037108125399872
2021-06-30 09:33:48   O-recall = 0.9051586030118551
2021-06-30 09:33:48   O-f1-score = 0.9044341283816231
2021-06-30 09:33:48   O-support = 6242
2021-06-30 09:33:48   loss = 6.979343056678772
2021-06-30 09:33:48   dataset = dev
2021-06-30 09:34:41 ***** Epoch end: 8 *****
2021-06-30 09:34:41 ***** Running evaluation *****
2021-06-30 09:34:41   Num examples = 244
2021-06-30 09:34:41   Batch size = 64
2021-06-30 09:34:47   macro_f1 = 0.9028405422853454
2021-06-30 09:34:47   micro_f1 = 0.9028405422853454
2021-06-30 09:34:47   support = 6242
2021-06-30 09:34:47   O-precision = 0.9095934959349593
2021-06-30 09:34:47   O-recall = 0.8961871195129766
2021-06-30 09:34:47   O-f1-score = 0.9028405422853454
2021-06-30 09:34:47   O-support = 6242
2021-06-30 09:34:47   loss = 7.946930527687073
2021-06-30 09:34:47   dataset = dev
2021-06-30 09:35:40 ***** Epoch end: 9 *****
2021-06-30 09:35:40 ***** Running evaluation *****
2021-06-30 09:35:40   Num examples = 244
2021-06-30 09:35:40   Batch size = 64
2021-06-30 09:35:47   macro_f1 = 0.9059664337910543
2021-06-30 09:35:47   micro_f1 = 0.9059664337910543
2021-06-30 09:35:47   support = 6242
2021-06-30 09:35:47   O-precision = 0.9082273385928192
2021-06-30 09:35:47   O-recall = 0.9037167574495354
2021-06-30 09:35:47   O-f1-score = 0.9059664337910543
2021-06-30 09:35:47   O-support = 6242
2021-06-30 09:35:47   loss = 8.445262789726257
2021-06-30 09:35:47   dataset = dev
2021-06-30 09:36:40 ***** Epoch end: 10 *****
2021-06-30 09:36:40 ***** Running evaluation *****
2021-06-30 09:36:40   Num examples = 244
2021-06-30 09:36:40   Batch size = 64
2021-06-30 09:36:46   macro_f1 = 0.905402141534498
2021-06-30 09:36:46   micro_f1 = 0.905402141534498
2021-06-30 09:36:46   support = 6242
2021-06-30 09:36:46   O-precision = 0.9100178022333711
2021-06-30 09:36:46   O-recall = 0.9008330663248959
2021-06-30 09:36:46   O-f1-score = 0.905402141534498
2021-06-30 09:36:46   O-support = 6242
2021-06-30 09:36:46   loss = 8.990850448608398
2021-06-30 09:36:46   dataset = dev
2021-06-30 09:36:47 ***** Training end *****
2021-06-30 09:36:47   Model path = ../output/cws_20210630_bert_crf_bert_base/model/model.pt
2021-06-30 09:36:47 ***** Loading data *****
2021-06-30 09:36:47   Data path = ../data/datasets/canton_ws/test.json
2021-06-30 09:36:47   Number of raw samples = 245
2021-06-30 09:36:48   Number of loaded samples = 245
2021-06-30 09:36:48 ***** Running evaluation *****
2021-06-30 09:36:48   Num examples = 1956
2021-06-30 09:36:48   Batch size = 64
2021-06-30 09:37:39   macro_f1 = 0.9923876134002332
2021-06-30 09:37:39   micro_f1 = 0.9923876134002332
2021-06-30 09:37:39   support = 49344
2021-06-30 09:37:39   O-precision = 0.9927196771511427
2021-06-30 09:37:39   O-recall = 0.9920557717250325
2021-06-30 09:37:39   O-f1-score = 0.9923876134002332
2021-06-30 09:37:39   O-support = 49344
2021-06-30 09:37:39   loss = 0.4533617900263879
2021-06-30 09:37:39   dataset = train
2021-06-30 09:37:40 ***** Running evaluation *****
2021-06-30 09:37:40   Num examples = 244
2021-06-30 09:37:40   Batch size = 64
2021-06-30 09:37:46   macro_f1 = 0.9062199422891952
2021-06-30 09:37:46   micro_f1 = 0.9062199422891952
2021-06-30 09:37:46   support = 6242
2021-06-30 09:37:46   O-precision = 0.9068014116137312
2021-06-30 09:37:46   O-recall = 0.905639218199295
2021-06-30 09:37:46   O-f1-score = 0.9062199422891952
2021-06-30 09:37:46   O-support = 6242
2021-06-30 09:37:46   loss = 6.586900115013123
2021-06-30 09:37:46   dataset = dev
2021-06-30 09:37:46 ***** Running evaluation *****
2021-06-30 09:37:46   Num examples = 245
2021-06-30 09:37:46   Batch size = 64
2021-06-30 09:37:52   macro_f1 = 0.8996655518394648
2021-06-30 09:37:52   micro_f1 = 0.8996655518394648
2021-06-30 09:37:52   support = 6293
2021-06-30 09:37:52   O-precision = 0.9016759776536313
2021-06-30 09:37:52   O-recall = 0.8976640711902113
2021-06-30 09:37:52   O-f1-score = 0.8996655518394648
2021-06-30 09:37:52   O-support = 6293
2021-06-30 09:37:52   loss = 7.828590154647827
2021-06-30 09:37:52   dataset = test
